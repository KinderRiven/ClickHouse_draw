<mxfile host="app.diagrams.net" modified="2022-04-02T06:33:20.182Z" agent="5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.80 Safari/537.36" etag="9CStXOV0eSWmJ4xTg0O3" version="17.1.2" type="github">
  <diagram id="sOtxer5ZXchhq9oxjsp1" name="第 1 页">
    <mxGraphModel dx="4659" dy="2092" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-1" value="BackgroundJobsAssignee" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffff88;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="40" y="40" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-2" value="MergeTreeData &amp;amp; data" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="40" y="80" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-3" value="BackgroundTaskSchedulingSettings sleep_settings" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="40" y="110" width="280" height="30.000000000000004" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-4" value="pcg64 rng" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="40" y="140" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-5" value="std::atomic&amp;lt;size_t&amp;gt; no_work_done_count{0}" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="40" y="170" width="260" height="30.000000000000004" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-28" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="ex_lUb9hJ6ux8IgF76Ti-6" target="ex_lUb9hJ6ux8IgF76Ti-27">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-6" value="BackgroundSchedulePool::TaskHolder holder" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e51400;strokeColor=#B20000;fontStyle=1;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="40" y="200" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-7" value="std::mutex holder_mutex" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="40" y="230" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-16" value="Type type{Type::DataProcessing}" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="40" y="260" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-17" value="void start()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="40" y="290" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-18" value="void trigger()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="40" y="320" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-19" value="void postpone()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="40" y="350" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-20" value="void finish()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="40" y="380" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-21" value="void scheduleMergeMutateTask(ExecutableTaskPtr merge_task)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="40" y="410" width="360" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-22" value="void scheduleFetchTask(ExecutableTaskPtr fetch_task)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="40" y="440" width="310" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-69" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=Times New Roman;fontSize=15;fontColor=#000000;endArrow=classic;endFill=1;" edge="1" parent="1" source="ex_lUb9hJ6ux8IgF76Ti-23" target="ex_lUb9hJ6ux8IgF76Ti-68">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-40" y="485" />
              <mxPoint x="-40" y="660" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-23" value="void scheduleMoveTask(ExecutableTaskPtr move_task)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="40" y="470" width="310" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-24" value="void scheduleCommonTask(ExecutableTaskPtr common_task)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="40" y="500" width="350" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-25" value="BackgroundJobsAssignee( MergeTreeData &amp;amp; data_, Type type, ContextPtr global_context_)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="40" y="530" width="510" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-26" value="void threadFunc()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="40" y="560" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-27" value="BackgroundSchedulePoolTaskHolder" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffff88;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="680" y="195" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-29" value="BackgroundSchedulePoolTaskInfoPtr task_info" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e51400;strokeColor=#B20000;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="680" y="330" width="310" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-30" value="using BackgroundSchedulePoolTaskInfoPtr = std::shared_ptr&amp;lt;BackgroundSchedulePoolTaskInfo&amp;gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#1ba1e2;strokeColor=#006EAF;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="680" y="235" width="310" height="45" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-34" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;endArrow=block;endFill=0;" edge="1" parent="1" source="ex_lUb9hJ6ux8IgF76Ti-32" target="ex_lUb9hJ6ux8IgF76Ti-29">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-32" value="BackgroundSchedulePoolTaskInfo" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffff88;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="1080" y="237.5" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-35" value="BackgroundSchedulePoolTaskInfo(BackgroundSchedulePool &amp;amp; pool_, const std::string &amp;amp; log_name_, const BackgroundSchedulePool::TaskFunc &amp;amp; function_)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="1080" y="277.5" width="360" height="62.5" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-36" value="bool schedule()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="1080" y="340" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-37" value="bool scheduleAfter(size_t ms, bool overwrite = true)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="1080" y="370" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-38" value="void deactivate()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="1080" y="400" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-39" value="void activate()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="1080" y="430" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-40" value="bool activateAndSchedule()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="1080" y="460" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-41" value="Coordination::WatchCallback getWatchCallback()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="1080" y="490" width="290" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-42" value="void execute()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="1080" y="520" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-43" value="void scheduleImpl(std::lock_guard&amp;lt;std::mutex&amp;gt; &amp;amp; schedule_mutex_lock)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="1080" y="550" width="410" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-44" value="BackgroundSchedulePool &amp;amp; pool" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e51400;strokeColor=#B20000;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="1080" y="580" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-45" value="std::string log_name" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="1080" y="610" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-46" value="BackgroundSchedulePool::TaskFunc function" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="1080" y="640" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-47" value="std::mutex exec_mutex" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="1080" y="670" width="160" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-48" value="std::mutex schedule_mutex" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="1080" y="700" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-49" value="bool deactivated = false" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="1080" y="730" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-50" value="bool scheduled = false" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="1080" y="760" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-51" value="bool deactivated = false" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="1080" y="790" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-52" value="bool delayed = false" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="1080" y="820" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-53" value="bool executing = false" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="1080" y="850" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-54" value="BackgroundSchedulePool::DelayedTasks::iterator iterator" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="1080" y="880" width="330" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-56" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;endArrow=block;endFill=0;" edge="1" parent="1" source="ex_lUb9hJ6ux8IgF76Ti-55" target="ex_lUb9hJ6ux8IgF76Ti-17">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-55" value="holder = getContext()-&amp;gt;getSchedulePool().createTask(&quot;BackgroundJobsAssignee:&quot; + toString(type), [this]{ &lt;b style=&quot;font-size: 13px;&quot;&gt;threadFunc();&lt;/b&gt; });" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e51400;strokeColor=#B20000;strokeWidth=2;fontSize=13;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="-597.5" y="285" width="505" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-59" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=Times New Roman;fontSize=15;fontColor=#000000;endArrow=block;endFill=0;" edge="1" parent="1" source="ex_lUb9hJ6ux8IgF76Ti-58" target="ex_lUb9hJ6ux8IgF76Ti-26">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-60" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fontFamily=Times New Roman;fontSize=15;fontColor=#000000;endArrow=block;endFill=0;" edge="1" parent="1" source="ex_lUb9hJ6ux8IgF76Ti-58" target="ex_lUb9hJ6ux8IgF76Ti-55">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-58" value="&lt;div style=&quot;line-height: 18px ; font-size: 15px&quot;&gt;&lt;div style=&quot;font-size: 15px&quot;&gt;&lt;b&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;void&lt;/span&gt; &lt;span style=&quot;font-size: 15px&quot;&gt;BackgroundJobsAssignee&lt;/span&gt;::&lt;span style=&quot;font-size: 15px&quot;&gt;threadFunc&lt;/span&gt;()&lt;/b&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px&quot;&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;try&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px&quot;&gt;{&lt;/div&gt;&lt;/div&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div style=&quot;line-height: 18px ; font-size: 15px&quot;&gt;&lt;div style=&quot;font-size: 15px&quot;&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;bool&lt;/span&gt; succeed = &lt;span style=&quot;font-size: 15px&quot;&gt;false&lt;/span&gt;;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;line-height: 18px ; font-size: 15px&quot;&gt;&lt;div style=&quot;font-size: 15px&quot;&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;switch&lt;/span&gt; (type)&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;line-height: 18px ; font-size: 15px&quot;&gt;&lt;div style=&quot;font-size: 15px&quot;&gt;    {&lt;/div&gt;&lt;/div&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div style=&quot;line-height: 18px ; font-size: 15px&quot;&gt;&lt;div style=&quot;font-size: 15px&quot;&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;case&lt;/span&gt; &lt;span style=&quot;font-size: 15px&quot;&gt;Type&lt;/span&gt;::DataProcessing:&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div style=&quot;line-height: 18px ; font-size: 15px&quot;&gt;&lt;div style=&quot;font-size: 15px&quot;&gt;&lt;b&gt;            succeed = &lt;span style=&quot;font-size: 15px&quot;&gt;data&lt;/span&gt;.&lt;span style=&quot;font-size: 15px&quot;&gt;scheduleDataProcessingJob&lt;/span&gt;(*&lt;span style=&quot;font-size: 15px&quot;&gt;this&lt;/span&gt;);&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div style=&quot;line-height: 18px ; font-size: 15px&quot;&gt;&lt;div style=&quot;font-size: 15px&quot;&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;break&lt;/span&gt;;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div style=&quot;line-height: 18px ; font-size: 15px&quot;&gt;&lt;div style=&quot;font-size: 15px&quot;&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;case&lt;/span&gt; &lt;span style=&quot;font-size: 15px&quot;&gt;Type&lt;/span&gt;::Moving:&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div style=&quot;line-height: 18px ; font-size: 15px&quot;&gt;&lt;div style=&quot;font-size: 15px&quot;&gt;&lt;b&gt;            succeed = &lt;span style=&quot;font-size: 15px&quot;&gt;data&lt;/span&gt;.&lt;span style=&quot;font-size: 15px&quot;&gt;scheduleDataMovingJob&lt;/span&gt;(*&lt;span style=&quot;font-size: 15px&quot;&gt;this&lt;/span&gt;);&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div style=&quot;line-height: 18px ; font-size: 15px&quot;&gt;&lt;div style=&quot;font-size: 15px&quot;&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;break&lt;/span&gt;;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div style=&quot;line-height: 18px ; font-size: 15px&quot;&gt;&lt;div style=&quot;font-size: 15px&quot;&gt;    }&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div style=&quot;line-height: 18px ; font-size: 15px&quot;&gt;&lt;br style=&quot;font-size: 15px&quot;&gt;&lt;/div&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div style=&quot;line-height: 18px ; font-size: 15px&quot;&gt;&lt;div style=&quot;font-size: 15px&quot;&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;if&lt;/span&gt; (!succeed)&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;line-height: 18px ; font-size: 15px&quot;&gt;&lt;div style=&quot;font-size: 15px&quot;&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;	&lt;/span&gt;postpone&lt;/span&gt;();&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div style=&quot;line-height: 18px ; font-size: 15px&quot;&gt;&lt;div style=&quot;font-size: 15px&quot;&gt;}&lt;/div&gt;&lt;div style=&quot;font-size: 15px&quot;&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;catch&lt;/span&gt; (...)&lt;span style=&quot;font-size: 15px&quot;&gt; /// Catch any exception to avoid thread termination.&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 15px&quot;&gt;{&lt;/div&gt;&lt;/div&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px ; border: none ; padding: 0px&quot;&gt;&lt;div style=&quot;line-height: 18px ; font-size: 15px&quot;&gt;&lt;div style=&quot;font-size: 15px&quot;&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;tryLogCurrentException&lt;/span&gt;(__PRETTY_FUNCTION__);&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;line-height: 18px ; font-size: 15px&quot;&gt;&lt;div style=&quot;font-size: 15px&quot;&gt;&lt;span style=&quot;font-size: 15px&quot;&gt;postpone&lt;/span&gt;();&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div style=&quot;line-height: 18px ; font-size: 15px&quot;&gt;&lt;div style=&quot;font-size: 15px&quot;&gt;}&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;labelBackgroundColor=none;fontFamily=Helvetica;fontSize=15;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="-580" y="373.75" width="470" height="402.5" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-63" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=Times New Roman;fontSize=15;fontColor=#000000;endArrow=block;endFill=0;" edge="1" parent="1" source="ex_lUb9hJ6ux8IgF76Ti-61" target="ex_lUb9hJ6ux8IgF76Ti-18">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-60" y="230" />
              <mxPoint x="-60" y="335" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-61" value="holder-&amp;gt;schedule()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="-240" y="210" width="145" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-64" value="推迟" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#76608a;strokeColor=#432D57;fontColor=#ffffff;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="140" y="350" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-67" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=Times New Roman;fontSize=15;fontColor=#000000;endArrow=block;endFill=0;" edge="1" parent="1" source="ex_lUb9hJ6ux8IgF76Ti-66" target="ex_lUb9hJ6ux8IgF76Ti-19">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-40" y="160" />
              <mxPoint x="-40" y="365" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-66" value="holder-&amp;gt;scheduleAfter(next_time_to_execute, false)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="-390" y="140" width="295" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-68" value="bool res = getContext()-&amp;gt;getMovesExecutor()-&amp;gt;trySchedule(move_task);&lt;br&gt;res ? trigger() : postpone();" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#76608a;strokeColor=#432D57;fontColor=#ffffff;align=center;" vertex="1" parent="1">
          <mxGeometry x="40" y="640" width="410" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-77" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=-0.004;entryY=0.361;entryDx=0;entryDy=0;entryPerimeter=0;fontFamily=Helvetica;fontSize=17;fontColor=#000000;endArrow=block;endFill=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="ex_lUb9hJ6ux8IgF76Ti-74" target="ex_lUb9hJ6ux8IgF76Ti-58">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-620" y="880" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="-720" y="995" />
              <mxPoint x="-720" y="519" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-74" value="&lt;div style=&quot;line-height: 18px ; font-size: 15px&quot;&gt;&lt;div style=&quot;font-size: 15px&quot;&gt;&lt;div style=&quot;color: rgb(212 , 212 , 212) ; background-color: rgb(30 , 30 , 30) ; font-family: &amp;#34;menlo&amp;#34; , &amp;#34;monaco&amp;#34; , &amp;#34;courier new&amp;#34; , monospace ; font-size: 12px ; line-height: 18px&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #569cd6&quot;&gt;bool&lt;/span&gt; &lt;span style=&quot;color: #4ec9b0&quot;&gt;MergeTreeData&lt;/span&gt;::&lt;span style=&quot;color: #dcdcaa&quot;&gt;scheduleDataMovingJob&lt;/span&gt;(&lt;span style=&quot;color: #4ec9b0&quot;&gt;BackgroundJobsAssignee&lt;/span&gt; &lt;span style=&quot;color: #569cd6&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span style=&quot;color: #9cdcfe&quot;&gt;assignee&lt;/span&gt;)&lt;/div&gt;&lt;div&gt;{&lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;color: #c586c0&quot;&gt;if&lt;/span&gt; (&lt;span style=&quot;color: #9cdcfe&quot;&gt;parts_mover&lt;/span&gt;.&lt;span style=&quot;color: #9cdcfe&quot;&gt;moves_blocker&lt;/span&gt;.&lt;span style=&quot;color: #dcdcaa&quot;&gt;isCancelled&lt;/span&gt;())&lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;color: #c586c0&quot;&gt;return&lt;/span&gt; &lt;span style=&quot;color: #569cd6&quot;&gt;false&lt;/span&gt;;&lt;/div&gt;&lt;br&gt;&lt;div&gt;    &lt;span style=&quot;color: #569cd6&quot;&gt;auto&lt;/span&gt; moving_tagger = &lt;span style=&quot;color: #dcdcaa&quot;&gt;selectPartsForMove&lt;/span&gt;();&lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;color: #c586c0&quot;&gt;if&lt;/span&gt; (&lt;span style=&quot;color: #9cdcfe&quot;&gt;moving_tagger&lt;/span&gt;-&amp;gt;&lt;span style=&quot;color: #9cdcfe&quot;&gt;parts_to_move&lt;/span&gt;.&lt;span style=&quot;color: #dcdcaa&quot;&gt;empty&lt;/span&gt;())&lt;/div&gt;&lt;div&gt;        &lt;span style=&quot;color: #c586c0&quot;&gt;return&lt;/span&gt; &lt;span style=&quot;color: #569cd6&quot;&gt;false&lt;/span&gt;;&lt;/div&gt;&lt;br&gt;&lt;div&gt;    &lt;span style=&quot;color: #9cdcfe&quot;&gt;assignee&lt;/span&gt;.&lt;span style=&quot;color: #dcdcaa&quot;&gt;scheduleMoveTask&lt;/span&gt;(&lt;span style=&quot;color: #4ec9b0&quot;&gt;ExecutableLambdaAdapter&lt;/span&gt;::&lt;span style=&quot;color: #dcdcaa&quot;&gt;create&lt;/span&gt;(&lt;/div&gt;&lt;div&gt;        [&lt;span style=&quot;color: #569cd6&quot;&gt;this&lt;/span&gt;, &lt;span style=&quot;color: #9cdcfe&quot;&gt;moving_tagger&lt;/span&gt;] () &lt;span style=&quot;color: #569cd6&quot;&gt;mutable&lt;/span&gt;&lt;/div&gt;&lt;div&gt;        {&lt;/div&gt;&lt;div&gt;            &lt;span style=&quot;color: #c586c0&quot;&gt;return&lt;/span&gt; &lt;span style=&quot;color: #dcdcaa&quot;&gt;moveParts&lt;/span&gt;(moving_tagger);&lt;/div&gt;&lt;div&gt;        }, moves_assignee_trigger, &lt;span style=&quot;color: #dcdcaa&quot;&gt;getStorageID&lt;/span&gt;()));&lt;/div&gt;&lt;div&gt;    &lt;span style=&quot;color: #c586c0&quot;&gt;return&lt;/span&gt; &lt;span style=&quot;color: #569cd6&quot;&gt;true&lt;/span&gt;;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=none;align=left;labelBackgroundColor=none;fontFamily=Helvetica;fontSize=15;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="-580" y="840" width="550" height="310" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-81" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=17;fontColor=#000000;endArrow=block;endFill=0;" edge="1" parent="1" source="ex_lUb9hJ6ux8IgF76Ti-80" target="ex_lUb9hJ6ux8IgF76Ti-55">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-80" value="&lt;meta charset=&quot;utf-8&quot;&gt;&lt;div style=&quot;color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: menlo, monaco, &amp;quot;courier new&amp;quot;, monospace; font-weight: normal; font-size: 12px; line-height: 18px;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #4ec9b0&quot;&gt;BackgroundSchedulePool&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #569cd6&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #4ec9b0&quot;&gt;Context&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;::&lt;/span&gt;&lt;span style=&quot;color: #dcdcaa&quot;&gt;getSchedulePool&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;() &lt;/span&gt;&lt;span style=&quot;color: #569cd6&quot;&gt;const&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;{&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #569cd6&quot;&gt;auto&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt; lock = &lt;/span&gt;&lt;span style=&quot;color: #dcdcaa&quot;&gt;getLock&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;();&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c586c0&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt; (!&lt;/span&gt;&lt;span style=&quot;color: #9cdcfe&quot;&gt;shared&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #9cdcfe&quot;&gt;schedule_pool&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #9cdcfe&quot;&gt;shared&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #9cdcfe&quot;&gt;schedule_pool&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #dcdcaa&quot;&gt;emplace&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #9cdcfe&quot;&gt;settings&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #9cdcfe&quot;&gt;background_schedule_pool_size&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #4ec9b0&quot;&gt;CurrentMetrics&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;::BackgroundSchedulePoolTask, &lt;/span&gt;&lt;span style=&quot;color: #ce9178&quot;&gt;&quot;BgSchPool&quot;&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c586c0&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt; *&lt;/span&gt;&lt;span style=&quot;color: #9cdcfe&quot;&gt;shared&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #9cdcfe&quot;&gt;schedule_pool&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;}&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=none;align=left;labelBackgroundColor=none;fontFamily=Helvetica;fontSize=15;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="-1210" y="233.75" width="530" height="142.5" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-166" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontFamily=Helvetica;fontSize=15;fontColor=#000000;endArrow=block;endFill=0;" edge="1" parent="1" source="ex_lUb9hJ6ux8IgF76Ti-82" target="ex_lUb9hJ6ux8IgF76Ti-44">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-1425" y="-20" />
              <mxPoint x="1520" y="-20" />
              <mxPoint x="1520" y="595" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-82" value="BackgroundSchedulePool" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffff88;strokeColor=#36393d;strokeWidth=1;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-1530" y="200" width="210" height="37.5" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-83" value="Context" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffff88;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1210" y="193.75" width="130" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-85" value="TaskHolder createTask(const std::string &amp;amp; log_name, const TaskFunc &amp;amp; function)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;strokeWidth=1;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-1890" y="271.25" width="570" height="37.5" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-86" value="size_t getNumberOfThreads() const { return size; }" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;strokeWidth=1;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-1680" y="308.75" width="360" height="37.5" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-87" value="void threadFunction();" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;strokeWidth=1;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-1490" y="346.25" width="170" height="37.5" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-88" value="void delayExecutionThreadFunction();" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;strokeWidth=1;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-1600" y="383.75" width="280" height="37.5" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-104" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.25;entryY=0;entryDx=0;entryDy=0;fontFamily=Helvetica;fontSize=15;fontColor=#000000;endArrow=block;endFill=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="ex_lUb9hJ6ux8IgF76Ti-85" target="ex_lUb9hJ6ux8IgF76Ti-55">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-1280" y="290" />
              <mxPoint x="-1280" y="160" />
              <mxPoint x="-471" y="160" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-89" value="BackgroundSchedulePool(size_t size_, CurrentMetrics::Metric tasks_metric_, const char *thread_name_);" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;strokeWidth=1;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-2040" y="233.75" width="720" height="37.5" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-90" value="void scheduleDelayedTask(const TaskInfoPtr &amp;amp; task_info, size_t ms, std::lock_guard&amp;lt;std::mutex&amp;gt; &amp;amp; task_schedule_mutex_lock)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;strokeWidth=1;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-1810" y="421.25" width="490" height="48.75" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-91" value="void cancelDelayedTask(const TaskInfoPtr &amp;amp; task_info, std::lock_guard&amp;lt;std::mutex&amp;gt; &amp;amp; task_schedule_mutex_lock)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;strokeWidth=1;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-1750" y="470" width="430" height="48.75" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-92" value="const size_t size" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-1460" y="518.75" width="140" height="31.25" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-93" value="std::atomic&amp;lt;bool&amp;gt; shutdown {false}" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-1580" y="550" width="260" height="31.25" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-94" value="Threads threads" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-1450" y="581.25" width="130" height="31.25" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-95" value="Poco::NotificationQueue queue" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-1560" y="612.5" width="240" height="31.25" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-96" value="std::condition_variable wakeup_cond" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-1600" y="643.75" width="280" height="31.25" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-97" value="std::mutex delayed_tasks_mutex" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-1560" y="675" width="240" height="31.25" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-98" value="ThreadFromGlobalPool delayed_thread" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-1610" y="706.25" width="290" height="31.25" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-99" value="DelayedTasks delayed_tasks" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-1560" y="737.5" width="240" height="31.25" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-100" value="ThreadGroupStatusPtr thread_group" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-1580" y="768.75" width="260" height="31.25" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-101" value="CurrentMetrics::Metric tasks_metric" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-1580" y="800" width="260" height="31.25" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-102" value="std::string thread_name" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-1540" y="831.25" width="220" height="31.25" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-103" value="void attachToThreadGroup()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;strokeWidth=1;fontSize=15;" vertex="1" parent="1">
          <mxGeometry x="-1540" y="862.5" width="220" height="31.25" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-107" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=Helvetica;fontSize=15;fontColor=#000000;endArrow=block;endFill=1;" edge="1" parent="1" source="ex_lUb9hJ6ux8IgF76Ti-106" target="ex_lUb9hJ6ux8IgF76Ti-85">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-1960" y="365" />
              <mxPoint x="-1960" y="290" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-106" value="&lt;meta charset=&quot;utf-8&quot;&gt;&lt;div style=&quot;color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: menlo, monaco, &amp;quot;courier new&amp;quot;, monospace; font-weight: normal; font-size: 12px; line-height: 18px;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #4ec9b0&quot;&gt;BackgroundSchedulePool&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;::&lt;/span&gt;&lt;span style=&quot;color: #4ec9b0&quot;&gt;TaskHolder&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #4ec9b0&quot;&gt;BackgroundSchedulePool&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;::&lt;/span&gt;&lt;span style=&quot;color: #dcdcaa&quot;&gt;createTask&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #569cd6&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #4ec9b0&quot;&gt;std&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;::&lt;/span&gt;&lt;span style=&quot;color: #4ec9b0&quot;&gt;string&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #569cd6&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #9cdcfe&quot;&gt;name&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #569cd6&quot;&gt;const&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #4ec9b0&quot;&gt;TaskFunc&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #569cd6&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #9cdcfe&quot;&gt;function&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;{&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c586c0&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #dcdcaa&quot;&gt;TaskHolder&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #4ec9b0&quot;&gt;std&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;::&lt;/span&gt;&lt;span style=&quot;color: #dcdcaa&quot;&gt;make_shared&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #4ec9b0&quot;&gt;TaskInfo&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;&amp;gt;(*&lt;/span&gt;&lt;span style=&quot;color: #569cd6&quot;&gt;this&lt;/span&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;, name, function));&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #d4d4d4&quot;&gt;}&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;strokeWidth=1;fontSize=15;align=left;" vertex="1" parent="1">
          <mxGeometry x="-2560" y="320" width="560" height="90" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-108" value="explicit BackgroundSchedulePoolTaskHolder(const &lt;b&gt;BackgroundSchedulePoolTaskInfoPtr&lt;/b&gt; &amp;amp; task_info_) : task_info(task_info_) {}" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;" vertex="1" parent="1">
          <mxGeometry x="680" y="280" width="310" height="50" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-109" value="void StorageMergeTree::startBackgroundMovesIfNeeded()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="-600" y="1240" width="320" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-112" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontFamily=Helvetica;fontSize=15;fontColor=#000000;endArrow=block;endFill=1;" edge="1" parent="1" source="ex_lUb9hJ6ux8IgF76Ti-110" target="ex_lUb9hJ6ux8IgF76Ti-111">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-110" value="background_moves_assignee.start()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#76608a;strokeColor=#432D57;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="-510" y="1270" width="230" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-111" value="void BackgroundJobsAssignee::start()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="-200" y="1270" width="230" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-114" value="if (!holder) holder = getContext()-&amp;gt;getSchedulePool().createTask(&quot;BackgroundJobsAssignee:&quot; + toString(type), [this] { threadFunc(); });" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#76608a;strokeColor=#432D57;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="-200" y="1300" width="520" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-117" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=Helvetica;fontSize=15;fontColor=#000000;endArrow=block;endFill=1;" edge="1" parent="1" source="ex_lUb9hJ6ux8IgF76Ti-115" target="ex_lUb9hJ6ux8IgF76Ti-116">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-115" value="holder-&amp;gt;activateAndSchedule();" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#76608a;strokeColor=#432D57;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="-200" y="1340" width="190" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-116" value="bool BackgroundSchedulePoolTaskInfo::activateAndSchedule()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="360" y="1340" width="350" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-161" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=Helvetica;fontSize=15;fontColor=#000000;endArrow=block;endFill=1;" edge="1" parent="1" source="ex_lUb9hJ6ux8IgF76Ti-118" target="ex_lUb9hJ6ux8IgF76Ti-160">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-118" value="scheduleImpl(lock)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#76608a;strokeColor=#432D57;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="360" y="1370" width="350" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-126" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=Helvetica;fontSize=15;fontColor=#000000;endArrow=block;endFill=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="ex_lUb9hJ6ux8IgF76Ti-121" target="ex_lUb9hJ6ux8IgF76Ti-122">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-119" value="void BackgroundJobsAssignee::scheduleMoveTask(ExecutableTaskPtr move_task)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="-350" y="1390" width="390" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-120" value="bool res = getContext()-&amp;gt;getMovesExecutor()-&amp;gt;trySchedule(move_task);" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#76608a;strokeColor=#432D57;fontColor=#ffffff;align=center;" vertex="1" parent="1">
          <mxGeometry x="-350" y="1430" width="390" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-121" value="res ? trigger() : postpone();" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#76608a;strokeColor=#432D57;fontColor=#ffffff;align=center;" vertex="1" parent="1">
          <mxGeometry x="-130" y="1460" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-122" value="void BackgroundJobsAssignee::trigger()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="100" y="1400" width="230" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-129" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=15;fontColor=#000000;endArrow=block;endFill=1;" edge="1" parent="1" source="ex_lUb9hJ6ux8IgF76Ti-127" target="ex_lUb9hJ6ux8IgF76Ti-128">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-127" value="holder-&amp;gt;schedule();" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#76608a;strokeColor=#432D57;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="100" y="1430" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-128" value="bool BackgroundSchedulePoolTaskInfo::schedule()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="360" y="1430" width="351" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-162" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=Helvetica;fontSize=15;fontColor=#000000;endArrow=block;endFill=1;" edge="1" parent="1" source="ex_lUb9hJ6ux8IgF76Ti-130" target="ex_lUb9hJ6ux8IgF76Ti-160">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-130" value="scheduleImpl(lock);" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#76608a;strokeColor=#432D57;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="360" y="1460" width="351" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-133" value="MergeMutateBackgroundExecutorPtr merge_mutate_executor" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1210" y="376.25" width="360" height="33.75" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-134" value="OrdinaryBackgroundExecutorPtr moves_executor" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1210" y="410" width="290" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-135" value="OrdinaryBackgroundExecutorPtr fetch_executor" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1210" y="440" width="290" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-136" value="OrdinaryBackgroundExecutorPtr common_executor" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1210" y="470" width="290" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-138" value="using MergeMutateBackgroundExecutor = MergeTreeBackgroundExecutor&amp;lt;MergeMutateRuntimeQueue&amp;gt;;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#eeeeee;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1210" y="500" width="360" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-139" value="OrdinaryBackgroundExecutor = MergeTreeBackgroundExecutor&amp;lt;OrdinaryRuntimeQueue&amp;gt;;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#eeeeee;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1210" y="540" width="360" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-157" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontFamily=Helvetica;fontSize=15;fontColor=#000000;endArrow=block;endFill=0;" edge="1" parent="1" source="ex_lUb9hJ6ux8IgF76Ti-140" target="ex_lUb9hJ6ux8IgF76Ti-138">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-140" value="template &amp;lt;class Queue&amp;gt;&lt;br&gt;MergeTreeBackgroundExecutor" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffff88;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1510" y="950" width="190" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-141" value="MergeTreeBackgroundExecutor( String name_, size_t threads_count_, size_t max_tasks_count_, CurrentMetrics::Metric metric_)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1760" y="990" width="440" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-142" value="bool trySchedule(ExecutableTaskPtr task)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1560" y="1030" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-143" value="void removeTasksCorrespondingToStorage(StorageID id)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1640" y="1060" width="320" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-144" value="void wait()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cdeb8b;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1400" y="1090" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-145" value="String name" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1400" y="1120" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-146" value="size_t threads_count{0}" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1460" y="1150" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-147" value="size_t max_tasks_count{0}" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1480" y="1180" width="160" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-148" value="CurrentMetrics::Metric metric" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1490" y="1210" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-149" value="void routine(TaskRuntimeDataPtr item)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1540" y="1240" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-150" value="void threadFunction()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1450" y="1270" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-151" value="Queue pending{}" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1450" y="1300" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-152" value="boost::circular_buffer&amp;lt;TaskRuntimeDataPtr&amp;gt; active{0}" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1630" y="1330" width="310" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-153" value="std::mutex mutex" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1430" y="1360" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-154" value="std::condition_variable has_tasks" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1510" y="1390" width="190" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-155" value="std::atomic_bool shutdown{false}" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1510" y="1420" width="190" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-156" value="ThreadPool pool" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#36393d;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="-1430" y="1450" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-160" value="void BackgroundSchedulePoolTaskInfo::scheduleImpl(std::lock_guard&amp;lt;std::mutex&amp;gt; &amp;amp; schedule_mutex_lock)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="800" y="1410" width="470" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ex_lUb9hJ6ux8IgF76Ti-164" value="pool.queue.enqueueNotification(new TaskNotification(shared_from_this()));" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#76608a;strokeColor=#432D57;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="800" y="1450" width="470" height="30" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
